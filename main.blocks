<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable type="KIND_SpriteKind" id=":!MzwonVhk~^Tv+@:(1:">gemsPlayer</variable><variable type="KIND_SpriteKind" id="wytK3ak|~-XVQB%,_ru]">gemsCatcher</variable><variable type="KIND_SpriteKind" id="a_7Y_,21VKx)R^Ur7.6[">gems</variable><variable type="KIND_SpriteKind" id="nTVV-a8Z*k[0!K?,Q.zE">getGemsKind</variable><variable type="KIND_SpriteKind" id="{XAJt3^grJQHaqu%d9o?">gemsKind</variable><variable type="KIND_SpriteKind" id="tfqlJYHuZjpoV?R/a~_h">iceMagic</variable><variable type="KIND_SpriteKind" id="{jndl;}.W$?*8HGO{n^[">fireMagic</variable></variables><block type="pxt-on-start" id=".LjlF0G0o,_EAHvPE}:r" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="m%y-wIbhRp^*^J}-LBQ2" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="namespace getgems {" line1="" line2="//角色碰到障碍物回退" line3="function goBack(){" line4=" if (heroDirection == 3) {" line5="        heroCol += -1" line6="    } else if (heroDirection == 0) {" line7="        heroRow += -1" line8="    } else if (heroDirection == 1) {" line9="        heroCol += 1" line10="    } else if (heroDirection == 2) {" line11="        heroRow += 1" line12="    }" line13="    scene.cameraShake(4, 500)" line14="    tiles.placeOnTile(gemsHero, tiles.getTileLocation(heroCol, heroRow))" line15="}" line16="" line17="//事件注册" line18="//9.23更新标记：魔法消除障碍物碰撞事件" line19="scene.onOverlapTile(SpriteKind.fireMagic, img`" line20="    . . . . . . c c . . . . . c c ." line21="    . . . c c . c 3 c . c c . c 3 c" line22="    . . c 3 6 c 3 3 c . c 3 c 6 3 c" line23="    . . c 3 3 3 3 6 c . c 3 6 3 3 c" line24="    . . . c 6 3 6 6 c c c 3 3 3 c ." line25="    . . . . c c 6 6 c 6 c 6 3 3 c ." line26="    . . . . c 3 c 6 c 3 3 c 6 6 c ." line27="    c c . c 3 3 c c c c 3 3 c 6 c ." line28="    c 3 c c 3 6 6 c 3 c 3 6 c 6 c ." line29="    c 3 3 6 3 6 3 6 3 3 3 c c c c c" line30="    . c 3 3 3 c 3 3 6 3 6 c c 3 3 c" line31="    . . c 3 3 c c 3 3 3 6 c 3 3 6 ." line32="    c c c 6 3 6 c c 6 3 6 6 3 6 c c" line33="    c 3 3 3 3 3 c c c 3 6 3 3 3 3 c" line34="    . c c 6 6 3 6 6 c 6 3 3 6 c c ." line35="    . . . c 6 3 3 6 6 6 6 3 c . . ." line36="`, function(sprite: Sprite, location: tiles.Location) {" line37="    tiles.setTileAt(tiles.getTileLocation(location.col,location.row), img`" line38="        . . . . . . . . . . . . . . . ." line39="        . . . . . . . . . . . . . . . ." line40="        . . . . . . . . . . . . . . . ." line41="        . . . . . . . . . . . . . . . ." line42="        . . . . . . . . . . . . . . . ." line43="        . . . . . . . . . . . . . . . ." line44="        . . . . . . . . . . . . . . . ." line45="        . . . . . . . . . . . . . . . ." line46="        . . . . . . . . . . . . . . . ." line47="        . . . . . . . . . . . . . . . ." line48="        . . . . . . . . . . . . . . . ." line49="        . . . . . . . . . . . . . . . ." line50="        . . . . . . . . . . . . . . . ." line51="        . . . . . . . . . . . . . . . ." line52="        . . . . . . . . . . . . . . . ." line53="        . . . . . . . . . . . . . . . ." line54="    `)" line55="})" line56="scene.onOverlapTile(SpriteKind.iceMagic, img`" line57="    5 4 4 5 5 4 4 4 4 2 2 2 4 4 4 4" line58="    4 4 4 4 4 5 5 4 2 2 2 2 4 4 4 5" line59="    4 2 2 2 4 4 5 4 2 2 4 4 5 5 5 5" line60="    2 2 4 2 4 4 5 4 2 2 4 5 5 5 5 4" line61="    2 2 2 2 4 4 5 4 2 2 4 4 5 5 4 4" line62="    4 2 2 2 4 5 5 4 4 4 4 4 4 4 4 2" line63="    2 2 2 4 4 5 5 5 4 4 2 2 2 2 2 2" line64="    4 2 2 4 5 5 5 5 4 2 2 4 2 2 2 4" line65="    5 4 4 4 4 4 4 5 5 4 2 2 2 4 4 4" line66="    4 4 4 2 2 2 4 4 5 5 4 4 4 4 5 5" line67="    4 2 2 2 2 2 2 2 4 5 5 5 5 5 5 5" line68="    5 4 4 2 4 2 2 4 4 5 5 5 4 4 4 5" line69="    5 5 4 2 2 2 4 4 4 5 5 4 2 2 2 4" line70="    4 5 4 4 4 4 5 5 5 5 4 2 4 2 2 4" line71="    4 5 5 5 5 5 5 4 4 4 2 4 2 4 2 4" line72="    4 5 5 5 4 4 4 4 2 2 2 2 4 2 4 4" line73="`, function(sprite: Sprite, location: tiles.Location) {" line74="    tiles.setTileAt(tiles.getTileLocation(location.col,location.row), img`" line75="        . . . . . . . . . . . . . . . ." line76="        . . . . . . . . . . . . . . . ." line77="        . . . . . . . . . . . . . . . ." line78="        . . . . . . . . . . . . . . . ." line79="        . . . . . . . . . . . . . . . ." line80="        . . . . . . . . . . . . . . . ." line81="        . . . . . . . . . . . . . . . ." line82="        . . . . . . . . . . . . . . . ." line83="        . . . . . . . . . . . . . . . ." line84="        . . . . . . . . . . . . . . . ." line85="        . . . . . . . . . . . . . . . ." line86="        . . . . . . . . . . . . . . . ." line87="        . . . . . . . . . . . . . . . ." line88="        . . . . . . . . . . . . . . . ." line89="        . . . . . . . . . . . . . . . ." line90="        . . . . . . . . . . . . . . . ." line91="    `)" line92="})" line93="" line94="//碰到墙回退" line95="scene.onOverlapTile(SpriteKind.gemsPlayer, sprites.builtin.forestTiles0, function (sprite, location) {" line96="   pause(500) " line97="   goBack()" line98="" line99="})" line100="//碰到熔岩" line101="scene.onOverlapTile(SpriteKind.gemsPlayer, img`" line102="    5 4 4 5 5 4 4 4 4 2 2 2 4 4 4 4" line103="    4 4 4 4 4 5 5 4 2 2 2 2 4 4 4 5" line104="    4 2 2 2 4 4 5 4 2 2 4 4 5 5 5 5" line105="    2 2 4 2 4 4 5 4 2 2 4 5 5 5 5 4" line106="    2 2 2 2 4 4 5 4 2 2 4 4 5 5 4 4" line107="    4 2 2 2 4 5 5 4 4 4 4 4 4 4 4 2" line108="    2 2 2 4 4 5 5 5 4 4 2 2 2 2 2 2" line109="    4 2 2 4 5 5 5 5 4 2 2 4 2 2 2 4" line110="    5 4 4 4 4 4 4 5 5 4 2 2 2 4 4 4" line111="    4 4 4 2 2 2 4 4 5 5 4 4 4 4 5 5" line112="    4 2 2 2 2 2 2 2 4 5 5 5 5 5 5 5" line113="    5 4 4 2 4 2 2 4 4 5 5 5 4 4 4 5" line114="    5 5 4 2 2 2 4 4 4 5 5 4 2 2 2 4" line115="    4 5 4 4 4 4 5 5 5 5 4 2 4 2 2 4" line116="    4 5 5 5 5 5 5 4 4 4 2 4 2 4 2 4" line117="    4 5 5 5 4 4 4 4 2 2 2 2 4 2 4 4" line118="`, function(sprite: Sprite, location: tiles.Location) {" line119="    goBack()" line120="    gemsHero.say(&quot;there is lava ahead,I can not go!&quot;)" line121="" line122="})" line123="//碰到毒草" line124="scene.onOverlapTile(SpriteKind.gemsPlayer, img`" line125="    . . . . . . c c . . . . . c c ." line126="    . . . c c . c 3 c . c c . c 3 c" line127="    . . c 3 6 c 3 3 c . c 3 c 6 3 c" line128="    . . c 3 3 3 3 6 c . c 3 6 3 3 c" line129="    . . . c 6 3 6 6 c c c 3 3 3 c ." line130="    . . . . c c 6 6 c 6 c 6 3 3 c ." line131="    . . . . c 3 c 6 c 3 3 c 6 6 c ." line132="    c c . c 3 3 c c c c 3 3 c 6 c ." line133="    c 3 c c 3 6 6 c 3 c 3 6 c 6 c ." line134="    c 3 3 6 3 6 3 6 3 3 3 c c c c c" line135="    . c 3 3 3 c 3 3 6 3 6 c c 3 3 c" line136="    . . c 3 3 c c 3 3 3 6 c 3 3 6 ." line137="    c c c 6 3 6 c c 6 3 6 6 3 6 c c" line138="    c 3 3 3 3 3 c c c 3 6 3 3 3 3 c" line139="    . c c 6 6 3 6 6 c 6 3 3 6 c c ." line140="    . . . c 6 3 3 6 6 6 6 3 c . . ." line141="`, function(sprite: Sprite, location: tiles.Location) {" line142="    goBack()" line143="    gemsHero.say(&quot;There is poison plant,I can not go!&quot;)" line144="" line145="})" line146="" line147="//获得宝石事件" line148="sprites.onOverlap(SpriteKind.gemsCatcher, SpriteKind.gems, function(sprite: Sprite, otherSprite: Sprite) {" line149="    otherSprite.destroy()" line150="    info.player1.changeScoreBy(-1)" line151="})" line152="sprites.onOverlap(SpriteKind.getGemsKind, SpriteKind.gemsKind, function(sprite: Sprite, otherSprite: Sprite) {" line153="    otherSprite.destroy()" line154="    info.player1.changeScoreBy(-1)" line155="    gemsNum-=1" line156="})" line157="" line158="//关卡设定" line159="function levelset(level:number){" line160="   switch(level){" line161="&#9;&#9;&#9;&#9;case 1:" line162="                     tiles.setTilemap(tiles.createTilemap(hex`0a0008000202020202020202020202020202020202020202020202020202020202020202020102020202020202020203020202020202020202020202020202020202020202020202020202020202020202020202`, img`" line163="                         . . . . . . . . . ." line164="                         . . . . . . . . . ." line165="                         . . . . . . . . . ." line166="                         . . . . . . . . . ." line167="                         . . . . . . . . . ." line168="                         . . . . . . . . . ." line169="                         . . . . . . . . . ." line170="                         . . . . . . . . . ." line171="                     `, [myTiles.transparency16,sprites.dungeon.buttonTealDepressed,sprites.builtin.forestTiles0,sprites.dungeon.collectibleInsignia], TileScale.Sixteen))   " line172="&#9;&#9;&#9;&#9;&#9;break;" line173="&#9;&#9;&#9;&#9;case 2:" line174="                    tiles.setTilemap(tiles.createTilemap(hex`0a0008000101010101010101010101010101010101010101010101000003000001010101010000010002010101010101010100010101010101010000000101010101010101010101010101010101010101010101`, img`" line175="                        . . . . . . . . . ." line176="                        . . . . . . . . . ." line177="                        . . . . . . . . . ." line178="                        . . . . . . . . . ." line179="                        . . . . . . . . . ." line180="                        . . . . . . . . . ." line181="                        . . . . . . . . . ." line182="                        . . . . . . . . . ." line183="                    `, [myTiles.transparency16,sprites.builtin.forestTiles0,sprites.dungeon.collectibleInsignia,sprites.dungeon.buttonTealDepressed], TileScale.Sixteen))" line184="                    break;" line185="&#9;&#9;&#9;&#9;case 3:" line186="                    tiles.setTilemap(tiles.createTilemap(hex`0a0008000301010101010201010100010101010100010101000101010101000101010001010101010001010100010101010100010101000101010101000101010200000000000201010101010101010101010101`, img`" line187="                        . . . . . . . . . ." line188="                        . . . . . . . . . ." line189="                        . . . . . . . . . ." line190="                        . . . . . . . . . ." line191="                        . . . . . . . . . ." line192="                        . . . . . . . . . ." line193="                        . . . . . . . . . ." line194="                        . . . . . . . . . ." line195="                    `, [myTiles.transparency16,sprites.builtin.forestTiles0,sprites.dungeon.collectibleInsignia,sprites.dungeon.buttonTealDepressed], TileScale.Sixteen))" line196="                    break;" line197="                case 4:" line198="                    tiles.setTilemap(tiles.createTilemap(hex`0a0008000101010101010101010101010101010101010101010101000004020101010101010000010101010101020500000101010101010101000003010101010101010101010101010101010101010101010101`, img`" line199="                        . . . . . . . . . ." line200="                        . . . . . . . . . ." line201="                        . . . . . . . . . ." line202="                        . . . . . . . . . ." line203="                        . . . . . . . . . ." line204="                        . . . . . . . . . ." line205="                        . . . . . . . . . ." line206="                        . . . . . . . . . ." line207="                    `, [myTiles.transparency16,sprites.builtin.forestTiles0,sprites.dungeon.collectibleInsignia,sprites.dungeon.buttonTealDepressed,sprites.dungeon.hazardLava1,sprites.builtin.coral0], TileScale.Sixteen))" line208="                    break;" line209="                    " line210="&#9;&#9;&#9;}    " line211="}" line212="" line213="" line214="//变量声明" line215="let gem: Sprite = null" line216="let gemsHero: Sprite = null" line217="let heroDirection = 0" line218="let gemsNum = 0 " line219="let level = 1" line220="let heroRow = 0" line221="let heroCol = 0" line222="heroDirection = 0" line223="export enum turnDirection{" line224="    left," line225="    right" line226="    }" line227="export enum magicKind{" line228="    fire ," line229="    ice" line230="}" line231="export enum obastaleKind{" line232="    lava ," line233="    plant" line234="}" line235="export let frontOfHero ={" line236="    //行" line237="    row:0," line238="    //列" line239="    col:0" line240="}" line241="" line242="" line243="//获取角色前方" line244="function getTheFrontOfHero():any{" line245="let addRow = 0" line246="let addCol = 0" line247=" if (heroDirection == 3) {" line248="        addCol += 1" line249="    } else if (heroDirection == 0) {" line250="        addRow += 1" line251="    } else if (heroDirection == 1) {" line252="        addCol += -1" line253="    } else if (heroDirection == 2) {" line254="        addRow += -1" line255="    }" line256="" line257="frontOfHero.row = heroRow+addRow" line258="frontOfHero.col = heroCol+addCol" line259="return frontOfHero" line260="}" line261="" line262="" line263="//初始化" line264="//%block" line265="//%group=&quot;Operate&quot;" line266="export function initGame(){ " line267="    gemsHero = sprites.create(img`" line268="    . . . . . . f f f f . . . . . ." line269="    . . . . f f f 2 2 f f f . . . ." line270="    . . . f f f 2 2 2 2 f f f . . ." line271="    . . f f f e e e e e e f f f . ." line272="    . . f f e 2 2 2 2 2 2 e e f . ." line273="    . . f e 2 f f f f f f 2 e f . ." line274="    . . f f f f e e e e f f f f . ." line275="    . f f e f b f 4 4 f b f e f f ." line276="    . f e e 4 1 f d d f 1 4 e e f ." line277="    . . f e e d d d d d d e e f . ." line278="    . . . f e e 4 4 4 4 e e f . . ." line279="    . . e 4 f 2 2 2 2 2 2 f 4 e . ." line280="    . . 4 d f 2 2 2 2 2 2 f d 4 . ." line281="    . . 4 4 f 4 4 5 5 4 4 f 4 4 . ." line282="    . . . . . f f f f f f . . . . ." line283="    . . . . . f f . . f f . . . . ." line284="`, SpriteKind.gemsPlayer)" line285="    level = game.askForNumber(&quot;set level(1-6)&quot;)" line286="    levelset(level)" line287="    tiles.placeOnRandomTile(gemsHero, img`" line288="        b b b b b b b b b b b b b b b b" line289="        b c b b b b b b b b b b b b c b" line290="        b b b c 6 6 6 6 6 6 6 6 c b b b" line291="        b b c 6 6 6 6 6 6 6 6 6 6 c b b" line292="        b b 6 6 6 6 6 6 6 6 6 6 6 6 b b" line293="        b b 6 6 6 6 6 6 6 6 6 6 6 6 b b" line294="        b b 6 6 6 6 6 6 6 6 6 6 6 6 b b" line295="        b b 6 6 6 6 6 6 6 6 6 6 6 6 b b" line296="        b b 6 6 6 6 6 6 6 6 6 6 6 6 b b" line297="        b b 9 6 6 6 6 6 6 6 6 6 6 9 b b" line298="        b b 9 6 6 6 6 6 6 6 6 6 6 9 b b" line299="        b b 6 9 6 6 6 6 6 6 6 6 9 6 b b" line300="        b b c 6 9 9 9 9 9 9 9 9 6 c b b" line301="        b b b c c c c c c c c c c b b b" line302="        b c b b b b b b b b b b b b c b" line303="        b b b b b b b b b b b b b b b b" line304="    `)" line305="    pause(500)" line306="    for (let 值 of tiles.getTilesByType(sprites.dungeon.collectibleInsignia)) {" line307="        gem = sprites.create(img`" line308="            . . . . . . . . . . . . . . . ." line309="            . . . . . . 4 4 4 4 . . . . . ." line310="            . . . . 4 4 4 5 5 4 4 4 . . . ." line311="            . . . 3 3 3 3 4 4 4 4 4 4 . . ." line312="            . . 4 3 3 3 3 2 2 2 1 1 4 4 . ." line313="            . . 3 3 3 3 3 2 2 2 1 1 5 4 . ." line314="            . 4 3 3 3 3 2 2 2 2 2 5 5 4 4 ." line315="            . 4 3 3 3 2 2 2 4 4 4 4 5 4 4 ." line316="            . 4 4 3 3 2 2 4 4 4 4 4 4 4 4 ." line317="            . 4 2 3 3 2 2 4 4 4 4 4 4 4 4 ." line318="            . . 4 2 3 3 2 4 4 4 4 4 2 4 . ." line319="            . . 4 2 2 3 2 2 4 4 4 2 4 4 . ." line320="            . . . 4 2 2 2 2 2 2 2 2 4 . . ." line321="            . . . . 4 4 2 2 2 2 4 4 . . . ." line322="            . . . . . . 4 4 4 4 . . . . . ." line323="            . . . . . . . . . . . . . . . ." line324="        `, SpriteKind.gemsKind)" line325="        tiles.placeOnTile(gem, 值)" line326="        gemsNum+=1" line327="        info.player1.setScore(gemsNum)" line328="    }" line329="    gemsHero.z = 1000" line330="    heroRow = gemsHero.y/16-0.5" line331="    heroCol = gemsHero.x/16-0.5" line332="    gemsHero.say(&quot;改程序前，先画流程图&quot;)" line333="}" line334="" line335="//获得宝石" line336="//%block" line337="//%group=&quot;Operate&quot;" line338="export function takeGems(){" line339="    gemsHero.setKind(SpriteKind.getGemsKind)" line340="    pause(100)" line341="    music.baDing.play()" line342="    gemsHero.setFlag(SpriteFlag.Ghost, true)" line343="    gemsHero.y-=5" line344="    pause(100)" line345="    gemsHero.setKind(SpriteKind.gemsPlayer)" line346="    gemsHero.setFlag(SpriteFlag.Ghost, false)" line347="    gemsHero.y+=5" line348="    if(gemsNum==0){" line349="        game.over(true)" line350="    }" line351="}" line352="" line353="" line354="//施法" line355="function actionOfMagic(isIceMagic:boolean){" line356="" line357="    if(isIceMagic){" line358="        let magicCube = sprites.create(img`" line359="            . . . . . . . . . . . . . . . ." line360="            . . . . . . . . . . . . . . . ." line361="            . . . . . . . . . . . . . . . ." line362="            . . . . . . . . . . . . . . . ." line363="            . . . . . . . . . . . . . . . ." line364="            . . . . 8 8 8 8 8 8 8 . . . . ." line365="            . . . . 8 1 1 1 1 1 8 . . . . ." line366="            . . . . 8 1 1 1 1 1 8 . . . . ." line367="            . . . . 8 1 1 9 1 1 8 . . . . ." line368="            . . . . 8 1 1 1 1 1 8 . . . . ." line369="            . . . . 8 1 1 1 1 1 8 . . . . ." line370="            . . . . 8 8 8 8 8 8 8 . . . . ." line371="            . . . . . . . . . . . . . . . ." line372="            . . . . . . . . . . . . . . . ." line373="            . . . . . . . . . . . . . . . ." line374="            . . . . . . . . . . . . . . . ." line375="        `,SpriteKind.iceMagic)" line376="        tiles.placeOnTile(magicCube, tiles.getTileLocation(frontOfHero.col, frontOfHero.row))" line377="        pause(500)" line378="        magicCube.destroy(effects.coolRadial,500)" line379="    }" line380="    else{" line381="        let magicCube2 = sprites.create(img`" line382="            . . . . . . . . . . . . . . . ." line383="            . . . . . . . . . . . . . . . ." line384="            . . . . . . . . . . . . . . . ." line385="            . . . . . . . . . . . . . . . ." line386="            . . . . . . . . . . . . . . . ." line387="            . . . . 2 2 2 2 2 2 2 . . . . ." line388="            . . . . 2 5 5 5 5 5 2 . . . . ." line389="            . . . . 2 5 5 5 5 5 2 . . . . ." line390="            . . . . 2 5 5 4 5 5 2 . . . . ." line391="            . . . . 2 5 5 5 5 5 2 . . . . ." line392="            . . . . 2 5 5 5 5 5 2 . . . . ." line393="            . . . . 2 2 2 2 2 2 2 . . . . ." line394="            . . . . . . . . . . . . . . . ." line395="            . . . . . . . . . . . . . . . ." line396="            . . . . . . . . . . . . . . . ." line397="            . . . . . . . . . . . . . . . ." line398="        `,SpriteKind.fireMagic)" line399="        tiles.placeOnTile(magicCube2, tiles.getTileLocation(frontOfHero.col, frontOfHero.row))" line400="        pause(500)" line401="        magicCube2.destroy(effects.fire,500)" line402="    }" line403="}" line404="//使用魔法" line405="//%block=&quot;use %magicKind magic&quot;" line406="//%group=&quot;Operate&quot;" line407="export function useMagic(choice:magicKind){" line408="    getTheFrontOfHero()" line409="    switch(choice){" line410="        case magicKind.ice:" line411="        if(tiles.tileAtLocationEquals(tiles.getTileLocation(frontOfHero.col, frontOfHero.row), img`" line412="            5 4 4 5 5 4 4 4 4 2 2 2 4 4 4 4" line413="            4 4 4 4 4 5 5 4 2 2 2 2 4 4 4 5" line414="            4 2 2 2 4 4 5 4 2 2 4 4 5 5 5 5" line415="            2 2 4 2 4 4 5 4 2 2 4 5 5 5 5 4" line416="            2 2 2 2 4 4 5 4 2 2 4 4 5 5 4 4" line417="            4 2 2 2 4 5 5 4 4 4 4 4 4 4 4 2" line418="            2 2 2 4 4 5 5 5 4 4 2 2 2 2 2 2" line419="            4 2 2 4 5 5 5 5 4 2 2 4 2 2 2 4" line420="            5 4 4 4 4 4 4 5 5 4 2 2 2 4 4 4" line421="            4 4 4 2 2 2 4 4 5 5 4 4 4 4 5 5" line422="            4 2 2 2 2 2 2 2 4 5 5 5 5 5 5 5" line423="            5 4 4 2 4 2 2 4 4 5 5 5 4 4 4 5" line424="            5 5 4 2 2 2 4 4 4 5 5 4 2 2 2 4" line425="            4 5 4 4 4 4 5 5 5 5 4 2 4 2 2 4" line426="            4 5 5 5 5 5 5 4 4 4 2 4 2 4 2 4" line427="            4 5 5 5 4 4 4 4 2 2 2 2 4 2 4 4" line428="        `)){    " line429="            actionOfMagic(true)" line430="        }" line431="        else{" line432="            gemsHero.say(&quot;There is not hot lava need to be frozen!&quot;)" line433="        }" line434="        break" line435="        default:" line436="        if(tiles.tileAtLocationEquals(tiles.getTileLocation(frontOfHero.col, frontOfHero.row), img`" line437="            . . . . . . c c . . . . . c c ." line438="            . . . c c . c 3 c . c c . c 3 c" line439="            . . c 3 6 c 3 3 c . c 3 c 6 3 c" line440="            . . c 3 3 3 3 6 c . c 3 6 3 3 c" line441="            . . . c 6 3 6 6 c c c 3 3 3 c ." line442="            . . . . c c 6 6 c 6 c 6 3 3 c ." line443="            . . . . c 3 c 6 c 3 3 c 6 6 c ." line444="            c c . c 3 3 c c c c 3 3 c 6 c ." line445="            c 3 c c 3 6 6 c 3 c 3 6 c 6 c ." line446="            c 3 3 6 3 6 3 6 3 3 3 c c c c c" line447="            . c 3 3 3 c 3 3 6 3 6 c c 3 3 c" line448="            . . c 3 3 c c 3 3 3 6 c 3 3 6 ." line449="            c c c 6 3 6 c c 6 3 6 6 3 6 c c" line450="            c 3 3 3 3 3 c c c 3 6 3 3 3 3 c" line451="            . c c 6 6 3 6 6 c 6 3 3 6 c c ." line452="            . . . c 6 3 3 6 6 6 6 3 c . . ." line453="        `)){    " line454="            actionOfMagic(false)" line455="        }else{" line456="            gemsHero.say(&quot;There is not poison plant need to be fired!&quot;)" line457="        }" line458="        break" line459="    }" line460="}" line461="    //判断前方障碍物" line462="    //% block=&quot;there is %obstaleKind ahead&quot;" line463="    export function isObastaleAhead(choice:obastaleKind): boolean {" line464="        getTheFrontOfHero()" line465="        if(choice == obastaleKind.lava){" line466="            if(tiles.tileAtLocationEquals(tiles.getTileLocation(frontOfHero.col, frontOfHero.row), img`" line467="                5 4 4 5 5 4 4 4 4 2 2 2 4 4 4 4" line468="                4 4 4 4 4 5 5 4 2 2 2 2 4 4 4 5" line469="                4 2 2 2 4 4 5 4 2 2 4 4 5 5 5 5" line470="                2 2 4 2 4 4 5 4 2 2 4 5 5 5 5 4" line471="                2 2 2 2 4 4 5 4 2 2 4 4 5 5 4 4" line472="                4 2 2 2 4 5 5 4 4 4 4 4 4 4 4 2" line473="                2 2 2 4 4 5 5 5 4 4 2 2 2 2 2 2" line474="                4 2 2 4 5 5 5 5 4 2 2 4 2 2 2 4" line475="                5 4 4 4 4 4 4 5 5 4 2 2 2 4 4 4" line476="                4 4 4 2 2 2 4 4 5 5 4 4 4 4 5 5" line477="                4 2 2 2 2 2 2 2 4 5 5 5 5 5 5 5" line478="                5 4 4 2 4 2 2 4 4 5 5 5 4 4 4 5" line479="                5 5 4 2 2 2 4 4 4 5 5 4 2 2 2 4" line480="                4 5 4 4 4 4 5 5 5 5 4 2 4 2 2 4" line481="                4 5 5 5 5 5 5 4 4 4 2 4 2 4 2 4" line482="                4 5 5 5 4 4 4 4 2 2 2 2 4 2 4 4" line483="            `)){return true}return false}" line484="        else{if(tiles.tileAtLocationEquals(tiles.getTileLocation(frontOfHero.col, frontOfHero.row), img`" line485="            . . . . . . c c . . . . . c c ." line486="            . . . c c . c 3 c . c c . c 3 c" line487="            . . c 3 6 c 3 3 c . c 3 c 6 3 c" line488="            . . c 3 3 3 3 6 c . c 3 6 3 3 c" line489="            . . . c 6 3 6 6 c c c 3 3 3 c ." line490="            . . . . c c 6 6 c 6 c 6 3 3 c ." line491="            . . . . c 3 c 6 c 3 3 c 6 6 c ." line492="            c c . c 3 3 c c c c 3 3 c 6 c ." line493="            c 3 c c 3 6 6 c 3 c 3 6 c 6 c ." line494="            c 3 3 6 3 6 3 6 3 3 3 c c c c c" line495="            . c 3 3 3 c 3 3 6 3 6 c c 3 3 c" line496="            . . c 3 3 c c 3 3 3 6 c 3 3 6 ." line497="            c c c 6 3 6 c c 6 3 6 6 3 6 c c" line498="            c 3 3 3 3 3 c c c 3 6 3 3 3 3 c" line499="            . c c 6 6 3 6 6 c 6 3 3 6 c c ." line500="            . . . c 6 3 3 6 6 6 6 3 c . . ." line501="        `)){return true}return false}" line502="    }" line503="" line504="    //转向" line505="    //%block=&quot;turn %turnDirection&quot;" line506="    //%group=&quot;Move&quot;" line507="    export function turn (choice: turnDirection) {" line508="    switch(choice){" line509="        case turnDirection.right:" line510="        heroDirection += 1" line511="        heroDirection = heroDirection % 4" line512="        break" line513="        default :" line514="        heroDirection += 3" line515="        heroDirection = heroDirection % 4" line516="        break" line517="    }" line518="    if (heroDirection == 3) {//向右" line519="        gemsHero.setImage(img`" line520="            . . . . . . f f f f f f . . . ." line521="            . . . . f f e e e e f 2 f . . ." line522="            . . . f f e e e e f 2 2 2 f . ." line523="            . . . f e e e f f e e e e f . ." line524="            . . . f f f f e e 2 2 2 2 e f ." line525="            . . . f e 2 2 2 f f f f e 2 f ." line526="            . . f f f f f f f e e e f f f ." line527="            . . f f e 4 4 e b f 4 4 e e f ." line528="            . . f e e 4 d 4 1 f d d e f . ." line529="            . . . f e e e 4 d d d d f . . ." line530="            . . . . f f e e 4 4 4 e f . . ." line531="            . . . . . 4 d d e 2 2 2 f . . ." line532="            . . . . . e d d e 2 2 2 f . . ." line533="            . . . . . f e e f 4 5 5 f . . ." line534="            . . . . . . f f f f f f . . . ." line535="            . . . . . . . f f f . . . . . ." line536="        `)" line537="    } else if (heroDirection == 0) {//向下" line538="        gemsHero.setImage(img`" line539="            . . . . . . f f f f . . . . . ." line540="            . . . . f f f 2 2 f f f . . . ." line541="            . . . f f f 2 2 2 2 f f f . . ." line542="            . . f f f e e e e e e f f f . ." line543="            . . f f e 2 2 2 2 2 2 e e f . ." line544="            . . f e 2 f f f f f f 2 e f . ." line545="            . . f f f f e e e e f f f f . ." line546="            . f f e f b f 4 4 f b f e f f ." line547="            . f e e 4 1 f d d f 1 4 e e f ." line548="            . . f e e d d d d d d e e f . ." line549="            . . . f e e 4 4 4 4 e e f . . ." line550="            . . e 4 f 2 2 2 2 2 2 f 4 e . ." line551="            . . 4 d f 2 2 2 2 2 2 f d 4 . ." line552="            . . 4 4 f 4 4 5 5 4 4 f 4 4 . ." line553="            . . . . . f f f f f f . . . . ." line554="            . . . . . f f . . f f . . . . ." line555="        `)" line556="    } else if (heroDirection == 1) {//向左" line557="        gemsHero.setImage(img`" line558="            . . . . f f f f f f . . . . . ." line559="            . . . f 2 f e e e e f f . . . ." line560="            . . f 2 2 2 f e e e e f f . . ." line561="            . . f e e e e f f e e e f . . ." line562="            . f e 2 2 2 2 e e f f f f . . ." line563="            . f 2 e f f f f 2 2 2 e f . . ." line564="            . f f f e e e f f f f f f f . ." line565="            . f e e 4 4 f b e 4 4 e f f . ." line566="            . . f e d d f 1 4 d 4 e e f . ." line567="            . . . f d d d d 4 e e e f . . ." line568="            . . . f e 4 4 4 e e f f . . . ." line569="            . . . f 2 2 2 e d d 4 . . . . ." line570="            . . . f 2 2 2 e d d e . . . . ." line571="            . . . f 5 5 4 f e e f . . . . ." line572="            . . . . f f f f f f . . . . . ." line573="            . . . . . . f f f . . . . . . ." line574="        `)" line575="    } else if (heroDirection == 2) {//向上" line576="        gemsHero.setImage(img`" line577="            . . . . . . f f f f . . . . . ." line578="            . . . . f f e e e e f f . . . ." line579="            . . . f e e e f f e e e f . . ." line580="            . . f f f f f 2 2 f f f f f . ." line581="            . . f f e 2 e 2 2 e 2 e f f . ." line582="            . . f e 2 f 2 f f 2 f 2 e f . ." line583="            . . f f f 2 2 e e 2 2 f f f . ." line584="            . f f e f 2 f e e f 2 f e f f ." line585="            . f e e f f e e e e f e e e f ." line586="            . . f e e e e e e e e e e f . ." line587="            . . . f e e e e e e e e f . . ." line588="            . . e 4 f f f f f f f f 4 e . ." line589="            . . 4 d f 2 2 2 2 2 2 f d 4 . ." line590="            . . 4 4 f 4 4 4 4 4 4 f 4 4 . ." line591="            . . . . . f f f f f f . . . . ." line592="            . . . . . f f . . f f . . . . ." line593="        `)" line594="    }" line595="    pause(500)" line596="}" line597="    //前进" line598="    //%block" line599="    //%group=&quot;Move&quot;" line600="    export function stepForward () {" line601="    if (heroDirection == 3) {" line602="        heroCol += 1" line603="    } else if (heroDirection == 0) {" line604="        heroRow += 1" line605="    } else if (heroDirection == 1) {" line606="        heroCol += -1" line607="    } else if (heroDirection == 2) {" line608="        heroRow += -1" line609="    }" line610="    tiles.placeOnTile(gemsHero, tiles.getTileLocation(heroCol, heroRow))" line611="    pause(500)" line612="}" line613="" line614="" line615="}" numlines="616"></mutation><next><block type="getgems_initGame" id="(QV1kA{DRC!~RFi0eqCK"/></next></block></statement></block><block type="keyonevent" id="~L$(a%xfO0Th|a!T:nYv" x="2405" y="0"><field name="button">controller.A</field><field name="event">ControllerButtonEvent.Pressed</field><statement name="HANDLER"><block type="getgems_stepForward" id="0qH-)%-h=%1P#r]F*F3s"/></statement></block><block type="keyonevent" id="5mi1Z/yb1:/:t|ip#Y-C" x="2649" y="0"><field name="button">controller.B</field><field name="event">ControllerButtonEvent.Pressed</field><statement name="HANDLER"><block type="getgems_turn" id="5MoS*-UXh(o_(/nMW@89"><field name="turnDirection">getgems.turnDirection.left</field></block></statement></block><block type="keyonevent" id="EkjVSo%1.+5Il@%F7$B}" x="2899" y="0"><field name="button">controller.menu</field><field name="event">ControllerButtonEvent.Pressed</field><statement name="HANDLER"><block type="controls_if" id="@8.r.ze)VGj6UTV-jv7C"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="getgems_isObastaleAhead" id="8l]9PK{wf~?z4{u-eFOw"><field name="obstaleKind">getgems.obastaleKind.lava</field></block></value><statement name="DO0"><block type="getgems_useMagic" id="=L9tFyPa9g=yEK+%=JuL"><field name="magicKind">getgems.magicKind.ice</field></block></statement><next><block type="controls_if" id="|gxt3*T^a-N?a(*h#T+*"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="getgems_isObastaleAhead" id="`tyQjnlj[p7N6s8Fk@py"><field name="obstaleKind">getgems.obastaleKind.plant</field></block></value><statement name="DO0"><block type="getgems_useMagic" id="dU8Ok?VHii[JLG?j@xkW"><field name="magicKind">getgems.magicKind.fire</field></block></statement></block></next></block></statement></block></xml>